"use strict";exports.id=518,exports.ids=[518],exports.modules={74739:(e,t,r)=>{var n=r(25649);r.o(n,"redirect")&&r.d(t,{redirect:function(){return n.redirect}})},25649:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return a},RedirectType:function(){return n.RedirectType},notFound:function(){return o.notFound},permanentRedirect:function(){return n.permanentRedirect},redirect:function(){return n.redirect}});let n=r(12863),o=r(722);class s extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class a extends URLSearchParams{append(){throw new s}delete(){throw new s}set(){throw new s}sort(){throw new s}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},722:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isNotFoundError:function(){return o},notFound:function(){return n}});let r="NEXT_NOT_FOUND";function n(){let e=Error(r);throw e.digest=r,e}function o(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},13809:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},12863:(e,t,r)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return n},getRedirectError:function(){return i},getRedirectStatusCodeFromError:function(){return h},getRedirectTypeFromError:function(){return f},getURLFromRedirectError:function(){return p},isRedirectError:function(){return d},permanentRedirect:function(){return c},redirect:function(){return u}});let o=r(54580),s=r(72934),a=r(13809),l="NEXT_REDIRECT";function i(e,t,r){void 0===r&&(r=a.RedirectStatusCode.TemporaryRedirect);let n=Error(l);n.digest=l+";"+t+";"+e+";"+r+";";let s=o.requestAsyncStorage.getStore();return s&&(n.mutableCookies=s.mutableCookies),n}function u(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw i(e,t,(null==r?void 0:r.isAction)?a.RedirectStatusCode.SeeOther:a.RedirectStatusCode.TemporaryRedirect)}function c(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw i(e,t,(null==r?void 0:r.isAction)?a.RedirectStatusCode.SeeOther:a.RedirectStatusCode.PermanentRedirect)}function d(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r,n,o]=e.digest.split(";",4),s=Number(o);return t===l&&("replace"===r||"push"===r)&&"string"==typeof n&&!isNaN(s)&&s in a.RedirectStatusCode}function p(e){return d(e)?e.digest.split(";",3)[2]:null}function f(e){if(!d(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function h(e){if(!d(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(n||(n={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},42343:(e,t,r)=>{r.d(t,{c:()=>e4});var n,o,s,a,l,i,u,c,d,p,f,h,m,g="vercel.ai.error",y=Symbol.for(g),v=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[n]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,g)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}};n=y;var b=v,w="AI_APICallError",_=`vercel.ai.error.${w}`,S=Symbol.for(_),E=class extends b{constructor({message:e,url:t,requestBodyValues:r,statusCode:n,responseHeaders:s,responseBody:a,cause:l,isRetryable:i=null!=n&&(408===n||409===n||429===n||n>=500),data:u}){super({name:w,message:e,cause:l}),this[o]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=s,this.responseBody=a,this.isRetryable=i,this.data=u}static isInstance(e){return b.hasMarker(e,_)}};o=S;var I="AI_EmptyResponseBodyError",z=`vercel.ai.error.${I}`,k=Symbol.for(z),j=class extends b{constructor({message:e="Empty response body"}={}){super({name:I,message:e}),this[s]=!0}static isInstance(e){return b.hasMarker(e,z)}};function x(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}s=k;var T="AI_InvalidArgumentError",R=`vercel.ai.error.${T}`,O=Symbol.for(R),$=class extends b{constructor({message:e,cause:t,argument:r}){super({name:T,message:e,cause:t}),this[a]=!0,this.argument=r}static isInstance(e){return b.hasMarker(e,R)}};a=O,Symbol.for("vercel.ai.error.AI_InvalidPromptError");var A="AI_InvalidResponseDataError",C=`vercel.ai.error.${A}`,N=Symbol.for(C),M=class extends b{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:A,message:t}),this[l]=!0,this.data=e}static isInstance(e){return b.hasMarker(e,C)}};l=N;var P="AI_JSONParseError",q=`vercel.ai.error.${P}`,F=Symbol.for(q),V=class extends b{constructor({text:e,cause:t}){super({name:P,message:`JSON parsing failed: Text: ${e}.
Error message: ${x(t)}`,cause:t}),this[i]=!0,this.text=e}static isInstance(e){return b.hasMarker(e,q)}};i=F,Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchModelError"),Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var D="AI_TypeValidationError",J=`vercel.ai.error.${D}`,U=Symbol.for(J),B=class e extends b{constructor({value:e,cause:t}){super({name:D,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${x(t)}`,cause:t}),this[u]=!0,this.value=e}static isInstance(e){return b.hasMarker(e,J)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}};u=U;var L="AI_UnsupportedFunctionalityError",H=`vercel.ai.error.${L}`,K=Symbol.for(H),G=class extends b{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:L,message:t}),this[c]=!0,this.functionality=e}static isInstance(e){return b.hasMarker(e,H)}};function W(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(W):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&W(t)))}c=K;var X=r(16748),Y=r(32425),Q=Object.defineProperty,Z=(e,t,r)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ee=(e,t,r)=>Z(e,"symbol"!=typeof t?t+"":t,r);class et extends Error{constructor(e,t){super(e),ee(this,"type"),ee(this,"field"),ee(this,"value"),ee(this,"line"),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function er(e){}class en extends TransformStream{constructor({onError:e,onRetry:t,onComment:r}={}){let n;super({start(o){n=function(e){let{onEvent:t=er,onError:r=er,onRetry:n=er,onComment:o}=e,s="",a=!0,l,i="",u="";function c(e){if(""===e){i.length>0&&t({id:l,event:u||void 0,data:i.endsWith(`
`)?i.slice(0,-1):i}),l=void 0,i="",u="";return}if(e.startsWith(":")){o&&o(e.slice(e.startsWith(": ")?2:1));return}let r=e.indexOf(":");if(-1!==r){let t=e.slice(0,r),n=" "===e[r+1]?2:1;d(t,e.slice(r+n),e);return}d(e,"",e)}function d(e,t,o){switch(e){case"event":u=t;break;case"data":i=`${i}${t}
`;break;case"id":l=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?n(parseInt(t,10)):r(new et(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:o}));break;default:r(new et(`Unknown field "${e.length>20?`${e.slice(0,20)}\u2026`:e}"`,{type:"unknown-field",field:e,value:t,line:o}))}}return{feed:function(e){let t=a?e.replace(/^\xEF\xBB\xBF/,""):e,[r,n]=function(e){let t=[],r="",n=e.length;for(let o=0;o<n;o++){let n=e[o];"\r"===n&&e[o+1]===`
`?(t.push(r),r="",o++):"\r"===n||n===`
`?(t.push(r),r=""):r+=n}return[t,r]}(`${s}${t}`);for(let e of r)c(e);s=n,a=!1},reset:function(e={}){s&&e.consume&&c(s),l=void 0,i="",u="",s=""}}}({onEvent:e=>{o.enqueue(e)},onError(t){"terminate"===e?o.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:r})},transform(e){n.feed(e)}})}}function eo(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function es(e){let t={};return e.headers.forEach((e,r)=>{t[r]=e}),t}var ea=(({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{let o=(0,X.k)(r,t);if(null==e)return o;if(r.includes(n))throw new $({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return t=>`${e}${n}${o(t)}`})();function el(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}var ei=Symbol.for("vercel.ai.validator");function eu({value:e,schema:t}){let r="object"==typeof t&&null!==t&&ei in t&&!0===t[ei]&&"validate"in t?t:{[ei]:!0,validate:e=>{let r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}};try{if(null==r.validate)return{success:!0,value:e};let t=r.validate(e);if(t.success)return t;return{success:!1,error:B.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:B.wrap({value:e,cause:t})}}}function ec({text:e,schema:t}){try{let r=Y.parse(e);if(null==t)return{success:!0,value:r,rawValue:r};let n=eu({value:r,schema:t});return n.success?{...n,rawValue:r}:n}catch(t){return{success:!1,error:V.isInstance(t)?t:new V({text:e,cause:t})}}}function ed(e){try{return Y.parse(e),!0}catch(e){return!1}}var ep=()=>globalThis.fetch,ef=async({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a})=>eh({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a}),eh=async({url:e,headers:t={},body:r,successfulResponseHandler:n,failedResponseHandler:o,abortSignal:s,fetch:a=ep()})=>{try{let l=await a(e,{method:"POST",headers:Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t)),body:r.content,signal:s}),i=es(l);if(!l.ok){let t;try{t=await o({response:l,url:e,requestBodyValues:r.values})}catch(t){if(el(t)||E.isInstance(t))throw t;throw new E({message:"Failed to process error response",cause:t,statusCode:l.status,url:e,responseHeaders:i,requestBodyValues:r.values})}throw t.value}try{return await n({response:l,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(el(t)||E.isInstance(t)))throw t;throw new E({message:"Failed to process successful response",cause:t,statusCode:l.status,url:e,responseHeaders:i,requestBodyValues:r.values})}}catch(t){if(el(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let n=t.cause;if(null!=n)throw new E({message:`Cannot connect to API: ${n.message}`,cause:n,url:e,requestBodyValues:r.values,isRetryable:!0})}throw t}},em=({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:n,url:o,requestBodyValues:s})=>{let a=await n.text(),l=es(n);if(""===a.trim())return{responseHeaders:l,value:new E({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:l,responseBody:a,isRetryable:null==r?void 0:r(n)})};try{let i=function({text:e,schema:t}){try{let r=Y.parse(e);if(null==t)return r;return function({value:e,schema:t}){let r=eu({value:e,schema:t});if(!r.success)throw B.wrap({value:e,cause:r.error});return r.value}({value:r,schema:t})}catch(t){if(V.isInstance(t)||B.isInstance(t))throw t;throw new V({text:e,cause:t})}}({text:a,schema:e});return{responseHeaders:l,value:new E({message:t(i),url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:l,responseBody:a,data:i,isRetryable:null==r?void 0:r(n,i)})}}catch(e){return{responseHeaders:l,value:new E({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:l,responseBody:a,isRetryable:null==r?void 0:r(n)})}}},eg=e=>async({response:t})=>{let r=es(t);if(null==t.body)throw new j({});return{responseHeaders:r,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new en).pipeThrough(new TransformStream({transform({data:t},r){"[DONE]"!==t&&r.enqueue(ec({text:t,schema:e}))}}))}},ey=e=>async({response:t,url:r,requestBodyValues:n})=>{let o=await t.text(),s=ec({text:o,schema:e}),a=es(t);if(!s.success)throw new E({message:"Invalid JSON response",cause:s.error,statusCode:t.status,responseHeaders:a,responseBody:o,url:r,requestBodyValues:n});return{responseHeaders:a,value:s.value,rawValue:s.rawValue}},{btoa:ev,atob:eb}=globalThis,ew=r(10692);function e_(e){var t,r;return null!=(r=null==(t=null==e?void 0:e.providerMetadata)?void 0:t.openaiCompatible)?r:{}}function eS({id:e,model:t,created:r}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function eE(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var eI={errorSchema:ew.z.object({error:ew.z.object({message:ew.z.string(),type:ew.z.string().nullish(),param:ew.z.any().nullish(),code:ew.z.union([ew.z.string(),ew.z.number()]).nullish()})}),errorToMessage:e=>e.error.message},ez=class{constructor(e,t,r){var n,o;this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r;let s=null!=(n=r.errorStructure)?n:eI;this.chunkSchema=ej(s.errorSchema),this.failedResponseHandler=em(s),this.supportsStructuredOutputs=null!=(o=r.supportsStructuredOutputs)&&o}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:r,temperature:n,topP:o,topK:s,frequencyPenalty:a,presencePenalty:l,stopSequences:i,responseFormat:u,seed:c}){var d,p;let f=e.type,h=[];null!=s&&h.push({type:"unsupported-setting",setting:"topK"}),(null==u?void 0:u.type)!=="json"||null==u.schema||this.supportsStructuredOutputs||h.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let m={model:this.modelId,user:this.settings.user,max_tokens:r,temperature:n,top_p:o,frequency_penalty:a,presence_penalty:l,response_format:(null==u?void 0:u.type)==="json"?!0===this.supportsStructuredOutputs&&null!=u.schema?{type:"json_schema",json_schema:{schema:u.schema,name:null!=(d=u.name)?d:"response",description:u.description}}:{type:"json_object"}:void 0,stop:i,seed:c,messages:function(e){let t=[];for(let{role:r,content:n,...o}of e){let e=e_({...o});switch(r){case"system":t.push({role:"system",content:n,...e});break;case"user":if(1===n.length&&"text"===n[0].type){t.push({role:"user",content:n[0].text,...e_(n[0])});break}t.push({role:"user",content:n.map(e=>{var t;let r=e_(e);switch(e.type){case"text":return{type:"text",text:e.text,...r};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(t=e.mimeType)?t:"image/jpeg"};base64,${function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return ev(t)}(e.image)}`},...r};case"file":throw new G({functionality:"File content parts in user messages"})}}),...e});break;case"assistant":{let r="",o=[];for(let e of n){let t=e_(e);switch(e.type){case"text":r+=e.text;break;case"tool-call":o.push({id:e.toolCallId,type:"function",function:{name:e.toolName,arguments:JSON.stringify(e.args)},...t});break;default:throw Error(`Unsupported part: ${e}`)}}t.push({role:"assistant",content:r,tool_calls:o.length>0?o:void 0,...e});break}case"tool":for(let e of n){let r=e_(e);t.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result),...r})}break;default:throw Error(`Unsupported role: ${r}`)}}return t}(t)};switch(f){case"regular":{let{tools:t,tool_choice:r,toolWarnings:n}=function({mode:e,structuredOutputs:t}){var r;let n=(null==(r=e.tools)?void 0:r.length)?e.tools:void 0,o=[];if(null==n)return{tools:void 0,tool_choice:void 0,toolWarnings:o};let s=e.toolChoice,a=[];for(let e of n)"provider-defined"===e.type?o.push({type:"unsupported-tool",tool:e}):a.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}});if(null==s)return{tools:a,tool_choice:void 0,toolWarnings:o};let l=s.type;switch(l){case"auto":case"none":case"required":return{tools:a,tool_choice:l,toolWarnings:o};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:s.toolName}},toolWarnings:o};default:throw new G({functionality:`Unsupported tool choice type: ${l}`})}}({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...m,tools:t,tool_choice:r},warnings:[...h,...n]}}case"object-json":return{args:{...m,response_format:!0===this.supportsStructuredOutputs&&null!=e.schema?{type:"json_schema",json_schema:{schema:e.schema,name:null!=(p=e.name)?p:"response",description:e.description}}:{type:"json_object"}},warnings:h};case"object-tool":return{args:{...m,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:h};default:throw Error(`Unsupported type: ${f}`)}}async doGenerate(e){var t,r,n,o,s,a,l,i,u;let{args:c,warnings:d}=this.getArgs({...e}),p=JSON.stringify(c),{responseHeaders:f,value:h,rawValue:m}=await ef({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:eo(this.config.headers(),e.headers),body:c,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:ey(ek),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:g,...y}=c,v=h.choices[0],b=null==(r=null==(t=this.config.metadataExtractor)?void 0:t.extractMetadata)?void 0:r.call(t,{parsedBody:m});return{text:null!=(n=v.message.content)?n:void 0,reasoning:null!=(o=v.message.reasoning_content)?o:void 0,toolCalls:null==(s=v.message.tool_calls)?void 0:s.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:ea(),toolName:e.function.name,args:e.function.arguments}}),finishReason:eE(v.finish_reason),usage:{promptTokens:null!=(l=null==(a=h.usage)?void 0:a.prompt_tokens)?l:NaN,completionTokens:null!=(u=null==(i=h.usage)?void 0:i.completion_tokens)?u:NaN},...b&&{providerMetadata:b},rawCall:{rawPrompt:g,rawSettings:y},rawResponse:{headers:f},response:eS(h),warnings:d,request:{body:p}}}async doStream(e){var t;if(this.settings.simulateStreaming){let t=await this.doGenerate(e);return{stream:new ReadableStream({start(e){if(e.enqueue({type:"response-metadata",...t.response}),t.reasoning&&e.enqueue({type:"reasoning",textDelta:t.reasoning}),t.text&&e.enqueue({type:"text-delta",textDelta:t.text}),t.toolCalls)for(let r of t.toolCalls)e.enqueue({type:"tool-call",...r});e.enqueue({type:"finish",finishReason:t.finishReason,usage:t.usage,logprobs:t.logprobs,providerMetadata:t.providerMetadata}),e.close()}}),rawCall:t.rawCall,rawResponse:t.rawResponse,warnings:t.warnings}}let{args:r,warnings:n}=this.getArgs({...e}),o=JSON.stringify({...r,stream:!0}),s=null==(t=this.config.metadataExtractor)?void 0:t.createStreamExtractor(),{responseHeaders:a,value:l}=await ef({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:eo(this.config.headers(),e.headers),body:{...r,stream:!0},failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:eg(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:i,...u}=r,c=[],d="unknown",p={promptTokens:void 0,completionTokens:void 0},f=!0;return{stream:l.pipeThrough(new TransformStream({transform(e,t){var r,n,o,a,l,i,u,h,m,g,y,v,b,w;if(!e.success){d="error",t.enqueue({type:"error",error:e.error});return}let _=e.value;if(null==s||s.processChunk(e.rawValue),"error"in _){d="error",t.enqueue({type:"error",error:_.error.message});return}f&&(f=!1,t.enqueue({type:"response-metadata",...eS(_)})),null!=_.usage&&(p={promptTokens:null!=(r=_.usage.prompt_tokens)?r:void 0,completionTokens:null!=(n=_.usage.completion_tokens)?n:void 0});let S=_.choices[0];if((null==S?void 0:S.finish_reason)!=null&&(d=eE(S.finish_reason)),(null==S?void 0:S.delta)==null)return;let E=S.delta;if(null!=E.reasoning_content&&t.enqueue({type:"reasoning",textDelta:E.reasoning_content}),null!=E.content&&t.enqueue({type:"text-delta",textDelta:E.content}),null!=E.tool_calls)for(let e of E.tool_calls){let r=e.index;if(null==c[r]){if("function"!==e.type)throw new M({data:e,message:"Expected 'function' type."});if(null==e.id)throw new M({data:e,message:"Expected 'id' to be a string."});if((null==(o=e.function)?void 0:o.name)==null)throw new M({data:e,message:"Expected 'function.name' to be a string."});c[r]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(a=e.function.arguments)?a:""},hasFinished:!1};let n=c[r];(null==(l=n.function)?void 0:l.name)!=null&&(null==(i=n.function)?void 0:i.arguments)!=null&&(n.function.arguments.length>0&&t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:n.id,toolName:n.function.name,argsTextDelta:n.function.arguments}),ed(n.function.arguments)&&(t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(u=n.id)?u:ea(),toolName:n.function.name,args:n.function.arguments}),n.hasFinished=!0));continue}let n=c[r];!n.hasFinished&&((null==(h=e.function)?void 0:h.arguments)!=null&&(n.function.arguments+=null!=(g=null==(m=e.function)?void 0:m.arguments)?g:""),t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:n.id,toolName:n.function.name,argsTextDelta:null!=(y=e.function.arguments)?y:""}),(null==(v=n.function)?void 0:v.name)!=null&&(null==(b=n.function)?void 0:b.arguments)!=null&&ed(n.function.arguments)&&(t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(w=n.id)?w:ea(),toolName:n.function.name,args:n.function.arguments}),n.hasFinished=!0))}},flush(e){var t,r;let n=null==s?void 0:s.buildMetadata();e.enqueue({type:"finish",finishReason:d,usage:{promptTokens:null!=(t=p.promptTokens)?t:NaN,completionTokens:null!=(r=p.completionTokens)?r:NaN},...n&&{providerMetadata:n}})}})),rawCall:{rawPrompt:i,rawSettings:u},rawResponse:{headers:a},warnings:n,request:{body:o}}}},ek=ew.z.object({id:ew.z.string().nullish(),created:ew.z.number().nullish(),model:ew.z.string().nullish(),choices:ew.z.array(ew.z.object({message:ew.z.object({role:ew.z.literal("assistant").nullish(),content:ew.z.string().nullish(),reasoning_content:ew.z.string().nullish(),tool_calls:ew.z.array(ew.z.object({id:ew.z.string().nullish(),type:ew.z.literal("function"),function:ew.z.object({name:ew.z.string(),arguments:ew.z.string()})})).nullish()}),finish_reason:ew.z.string().nullish()})),usage:ew.z.object({prompt_tokens:ew.z.number().nullish(),completion_tokens:ew.z.number().nullish()}).nullish()}),ej=e=>ew.z.union([ew.z.object({id:ew.z.string().nullish(),created:ew.z.number().nullish(),model:ew.z.string().nullish(),choices:ew.z.array(ew.z.object({delta:ew.z.object({role:ew.z.enum(["assistant"]).nullish(),content:ew.z.string().nullish(),reasoning_content:ew.z.string().nullish(),tool_calls:ew.z.array(ew.z.object({index:ew.z.number(),id:ew.z.string().nullish(),type:ew.z.literal("function").optional(),function:ew.z.object({name:ew.z.string().nullish(),arguments:ew.z.string().nullish()})})).nullish()}).nullish(),finish_reason:ew.z.string().nullish()})),usage:ew.z.object({prompt_tokens:ew.z.number().nullish(),completion_tokens:ew.z.number().nullish()}).nullish()}),e]),ex=(ew.z.object({id:ew.z.string().nullish(),created:ew.z.number().nullish(),model:ew.z.string().nullish(),choices:ew.z.array(ew.z.object({text:ew.z.string(),finish_reason:ew.z.string()})),usage:ew.z.object({prompt_tokens:ew.z.number(),completion_tokens:ew.z.number()}).nullish()}),ew.z.object({data:ew.z.array(ew.z.object({embedding:ew.z.array(ew.z.number())})),usage:ew.z.object({prompt_tokens:ew.z.number()}).nullish()}),"vercel.ai.error"),eT=Symbol.for(ex),eR=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[d]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,ex)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}};d=eT;var eO=eR,e$=(Symbol.for("vercel.ai.error.AI_APICallError"),Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError"),"AI_InvalidArgumentError"),eA=`vercel.ai.error.${e$}`,eC=Symbol.for(eA),eN=class extends eO{constructor({message:e,cause:t,argument:r}){super({name:e$,message:e,cause:t}),this[p]=!0,this.argument=r}static isInstance(e){return eO.hasMarker(e,eA)}};p=eC,Symbol.for("vercel.ai.error.AI_InvalidPromptError"),Symbol.for("vercel.ai.error.AI_InvalidResponseDataError"),Symbol.for("vercel.ai.error.AI_JSONParseError");var eM="AI_LoadAPIKeyError",eP=`vercel.ai.error.${eM}`,eq=Symbol.for(eP),eF=class extends eO{constructor({message:e}){super({name:eM,message:e}),this[f]=!0}static isInstance(e){return eO.hasMarker(e,eP)}};f=eq,Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var eV="AI_NoSuchModelError",eD=`vercel.ai.error.${eV}`,eJ=Symbol.for(eD),eU=class extends eO{constructor({errorName:e=eV,modelId:t,modelType:r,message:n=`No such ${r}: ${t}`}){super({name:e,message:n}),this[h]=!0,this.modelId=t,this.modelType=r}static isInstance(e){return eO.hasMarker(e,eD)}};h=eJ,Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var eB="AI_TypeValidationError",eL=`vercel.ai.error.${eB}`,eH=Symbol.for(eL),eK=class e extends eO{constructor({value:e,cause:t}){super({name:eB,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${function(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}(t)}`,cause:t}),this[m]=!0,this.value=e}static isInstance(e){return eO.hasMarker(e,eL)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}};function eG(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(eG):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&eG(t)))}m=eH,Symbol.for("vercel.ai.error.AI_UnsupportedFunctionalityError"),(({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{let o=(0,X.k)(r,t);if(null!=e){if(r.includes(n))throw new eN({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return t=>`${e}${n}${o(t)}`}})();var eW=Symbol.for("vercel.ai.validator");function eX({value:e,schema:t}){let r="object"==typeof t&&null!==t&&eW in t&&!0===t[eW]&&"validate"in t?t:{[eW]:!0,validate:e=>{let r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}};try{if(null==r.validate)return{success:!0,value:e};let t=r.validate(e);if(t.success)return t;return{success:!1,error:eK.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:eK.wrap({value:e,cause:t})}}}var{btoa:eY,atob:eQ}=globalThis,eZ=e=>{var t,r;return null==e?void 0:{deepseek:{promptCacheHitTokens:null!=(t=e.prompt_cache_hit_tokens)?t:NaN,promptCacheMissTokens:null!=(r=e.prompt_cache_miss_tokens)?r:NaN}}},e0={extractMetadata:({parsedBody:e})=>{let t=eX({value:e,schema:e2});return t.success&&null!=t.value.usage?eZ(t.value.usage):void 0},createStreamExtractor:()=>{let e;return{processChunk:t=>{var r,n;let o=eX({value:t,schema:e3});o.success&&(null==(n=null==(r=o.value.choices)?void 0:r[0])?void 0:n.finish_reason)==="stop"&&o.value.usage&&(e=o.value.usage)},buildMetadata:()=>eZ(e)}}},e1=ew.z.object({prompt_cache_hit_tokens:ew.z.number().nullish(),prompt_cache_miss_tokens:ew.z.number().nullish()}),e2=ew.z.object({usage:e1.nullish()}),e3=ew.z.object({choices:ew.z.array(ew.z.object({finish_reason:ew.z.string().nullish()})).nullish(),usage:e1.nullish()}),e4=function(e={}){var t,r;let n=null==(r=null!=(t=e.baseURL)?t:"https://api.deepseek.com/v1")?void 0:r.replace(/\/$/,""),o=()=>({Authorization:`Bearer ${function({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:n}){if("string"==typeof e)return e;if(null!=e)throw new eF({message:`${n} API key must be a string.`});if("undefined"==typeof process)throw new eF({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(null==(e=process.env[t]))throw new eF({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new eF({message:`${n} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}({apiKey:e.apiKey,environmentVariableName:"DEEPSEEK_API_KEY",description:"DeepSeek API key"})}`,...e.headers}),s=(t,r={})=>new ez(t,r,{provider:"deepseek.chat",url:({path:e})=>`${n}${e}`,headers:o,fetch:e.fetch,defaultObjectGenerationMode:"json",metadataExtractor:e0}),a=(e,t)=>s(e,t);return a.languageModel=s,a.chat=s,a.textEmbeddingModel=e=>{throw new eU({modelId:e,modelType:"textEmbeddingModel"})},a}()}};